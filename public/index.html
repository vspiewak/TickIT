<html>
    <head>
        <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="style/app.css">
    </head>
    <body>
        <div class="ticket">
            <div id="counter"></div>
        </div>
        <script src="vendor/jquery-1.10.2.min.js" type="text/javascript"></script>
        <script src="vendor/jquery.storageapi.min.js" type="text/javascript"></script>
        <script type="text/javascript">
        $(document).ready(function() {
            
            var counter = $.localStorage.get('counter') || { id: 0, code: 0 };

            var getCounter = function() {
                $.ajax({
                    url:'api/counter',
                    data: { id: counter.id },
                    success: function(data) {
                        if (counter.id != data.id) {
                            $.localStorage.set('counter', data);
                            $('#counter').text(data.code);
                        } else {
                            $('#counter').text(counter.code);
                        }
                    }
                });
            };
            getCounter();
        });
        </script>
    </body>
</html>
